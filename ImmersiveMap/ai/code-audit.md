# Code Audit

## 1. Критичные баги (crash, data corruption)
Критичных багов после исправлений не выявлено.

## 2. Логические ошибки
- `ImmersiveMapFramework/Renderer.swift:160` — принудительная установка `currentIndex = 0` отключает любую будущую поддержку мульти-текстур. Риск: low. Рекомендация: оставить комментарий о намеренном single‑buffer режиме или сделать флаг конфигурации.

## 3. Потенциально опасные места
- `ImmersiveMapFramework/Tile/Get/MapNeedsTile.swift:27` — синхронизация `ongoingTasks`/`fifo` через `DispatchQueue` может стать узким местом при большом потоке запросов. Риск: low. Рекомендация: при росте нагрузки рассмотреть `actor` или отдельный worker.
- `ImmersiveMapFramework/Tile/Get/TileDownloader.swift:17` — отсутствие `MAPBOX` приводит к тихому отсутствию загрузок (nil), что может выглядеть как “пустая карта”. Риск: low. Рекомендация: добавить явный лог/ошибку в debug режиме.

## 4. Архитектурные/поддерживаемость
- `ImmersiveMapFramework/MapParameters.swift:1` — конфигурация теперь инстанс‑based, но часть компонентов получает ее через конструкторы, а часть через default. Риск: low. Рекомендация: централизовать создание `MapConfiguration` в одном месте (например, в `ImmersiveMapView`) и явно передавать ее везде.
